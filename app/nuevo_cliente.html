<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
   <meta name="description" content="Bootstrap Admin App">
   <meta name="keywords" content="app, responsive, jquery, bootstrap, dashboard, admin">
   <link rel="icon" type="image/x-icon" href="favicon.ico">
   <title>Angle - Bootstrap Admin Template</title><!-- =============== VENDOR STYLES ===============-->
   <!-- FONT AWESOME-->
   <link rel="stylesheet" href="vendor/@fortawesome/fontawesome-free/css/brands.css">
   <link rel="stylesheet" href="vendor/@fortawesome/fontawesome-free/css/regular.css">
   <link rel="stylesheet" href="vendor/@fortawesome/fontawesome-free/css/solid.css">
   <link rel="stylesheet" href="vendor/@fortawesome/fontawesome-free/css/fontawesome.css"><!-- SIMPLE LINE ICONS-->
   <link rel="stylesheet" href="vendor/simple-line-icons/css/simple-line-icons.css"><!-- ANIMATE.CSS-->
   <link rel="stylesheet" href="vendor/animate.css/animate.css"><!-- WHIRL (spinners)-->
   <link rel="stylesheet" href="vendor/whirl/dist/whirl.css"><!-- =============== PAGE VENDOR STYLES ===============-->
   <!-- =============== BOOTSTRAP STYLES ===============-->
   <link rel="stylesheet" href="css/bootstrap.css" id="bscss"><!-- =============== APP STYLES ===============-->
   <link rel="stylesheet" href="css/app.css" id="maincss">
</head>

<body>
   <div class="wrapper">
      <!-- top navbar-->
      <header class="topnavbar-wrapper">
         <!-- START Top Navbar-->
         <nav class="navbar topnavbar">
            <!-- START navbar header-->
            <div class="navbar-header"><a class="navbar-brand" href="#/">
                  <div class="brand-logo"><img class="img-fluid" src="img/logo.png" alt="App Logo"></div>
                  <div class="brand-logo-collapsed"><img class="img-fluid" src="img/logo-single.png" alt="App Logo">
                  </div>
               </a></div><!-- END navbar header-->
            <!-- START Left navbar-->
            <ul class="navbar-nav mr-auto flex-row">
               <li class="nav-item">
                  <!-- Button used to collapse the left sidebar. Only visible on tablet and desktops--><a
                     class="nav-link d-none d-md-block d-lg-block d-xl-block" href="#" data-trigger-resize=""
                     data-toggle-state="aside-collapsed"><em class="fas fa-bars"></em></a>
                  <!-- Button to show/hide the sidebar on mobile. Visible on mobile only.--><a
                     class="nav-link sidebar-toggle d-md-none" href="#" data-toggle-state="aside-toggled"
                     data-no-persist="true"><em class="fas fa-bars"></em></a></li><!-- START User avatar toggle-->
               <li class="nav-item d-none d-md-block">
                  <!-- Button used to collapse the left sidebar. Only visible on tablet and desktops--><a
                     class="nav-link" id="user-block-toggle" href="#user-block" data-toggle="collapse"><em
                        class="icon-user"></em></a></li><!-- END User avatar toggle-->
               <!-- START lock screen-->

               <!-- START Right Navbar-->
               <ul class="navbar-nav flex-row">
                  <!-- Search icon-->
                  <!-- Fullscreen (only desktops)-->

                  <!-- START Alert menu-->

                  <!-- START Dropdown menu-->
                  <div class="dropdown-menu dropdown-menu-right animated flipInX">
                     <div class="dropdown-item">
                        <!-- START list group-->
                        <div class="list-group">
                           <!-- list item-->
                           <div class="list-group-item list-group-item-action">
                              <div class="media">
                                 <div class="align-self-start mr-2"><em class="fab fa-twitter fa-2x text-info"></em>
                                 </div>
                                 <div class="media-body">
                                    <p class="m-0">New followers</p>
                                    <p class="m-0 text-muted text-sm">1 new follower</p>
                                 </div>
                              </div>
                           </div><!-- list item-->
                           <div class="list-group-item list-group-item-action">
                              <div class="media">
                                 <div class="align-self-start mr-2"><em class="fas fa-envelope fa-2x text-warning"></em>
                                 </div>
                                 <div class="media-body">
                                    <p class="m-0">New e-mails</p>
                                    <p class="m-0 text-muted text-sm">You have 10 new emails</p>
                                 </div>
                              </div>
                           </div><!-- list item-->
                           <div class="list-group-item list-group-item-action">
                              <div class="media">
                                 <div class="align-self-start mr-2"><em class="fas fa-tasks fa-2x text-success"></em>
                                 </div>
                                 <div class="media-body">
                                    <p class="m-0">Pending Tasks</p>
                                    <p class="m-0 text-muted text-sm">11 pending task</p>
                                 </div>
                              </div>
                           </div><!-- last list item-->
                           <div class="list-group-item list-group-item-action"><span
                                 class="d-flex align-items-center"><span class="text-sm">More notifications</span><span
                                    class="badge badge-danger ml-auto">14</span></span></div>
                        </div><!-- END list group-->
                     </div>
                  </div><!-- END Dropdown menu-->
                  </li><!-- END Alert menu-->
                  <!-- START Offsidebar button-->

                  <!-- END Offsidebar menu-->
               </ul><!-- END Right Navbar-->
               <!-- START Search form-->
               <form class="navbar-form" role="search" action="search.html">
                  <div class="form-group"><input class="form-control" type="text" placeholder="Type and hit enter ...">
                     <div class="fas fa-times navbar-form-close" data-search-dismiss=""></div>
                  </div><button class="d-none" type="submit">Submit</button>
               </form><!-- END Search form-->
         </nav><!-- END Top Navbar-->
      </header><!-- sidebar-->
      <aside class="aside-container">
         <!-- START Sidebar (left)-->
         <div class="aside-inner">
            <nav class="sidebar" data-sidebar-anyclick-close="">
               <!-- START sidebar nav-->
               <ul class="sidebar-nav">
                  <!-- START user info-->
                  <li class="has-user-block">
                     <div class="collapse" id="user-block">
                        <div class="item user-block">
                           <!-- User picture-->
                           <div class="user-block-picture">
                              <div class="user-block-status"><img class="img-thumbnail rounded-circle"
                                    src="img/user/02.jpg" alt="Avatar" width="60" height="60">
                                 <div class="circle bg-success circle-lg"></div>
                              </div>
                           </div><!-- Name and Job-->
                           <div class="user-block-info"><span class="user-block-name">Hello, Mike</span><span
                                 class="user-block-role">Designer</span></div>
                        </div>
                     </div>
                  </li><!-- END user info-->
                  <!-- Iterates over all sidebar items-->
                  <li class="nav-heading "><span data-localize="sidebar.heading.HEADER">Menu Navigation</span>
                  </li>
                  <li class=""><a href="vista_ordenes.html" title="Ordenes"><em
                           class="far fa-file"></em><span>Ordenes</span></a></li>
                  <li class="active"><a href="vista_clientes.html" title="Clientes"><em
                           class="fa fa-user"></em><span>Clientes</span></a></li>
                  <li class=""><a href="vista_repuestos.html" title="Repuestos"><em
                           class="fa fa-wrench"></em><span>Repuestos</span></a></li>
                  <li class=""><a href="vista_vehiculos.html" title="Vehiculos"><em
                           class="fa fa-car"></em><span>Vehículos</span></a></li>
               </ul><!-- END sidebar nav-->
            </nav>
         </div><!-- END Sidebar (left)-->
      </aside><!-- offsidebar-->
      <section class="section-container">
         <!-- Page content-->
         <div class="content-wrapper">
            <div class="content-heading">
               <div>Clientes<small>Carpeta de clientes.</small></div>
            </div>
            <div class="row">
               <div class="col-lg-12">
                  <!-- START card-->
                  <div class="card card-default">
                     <div id="titulo" class="card-header"></div>
                     <div class="card-body">
                        <div class="form">
                           <div class="form-group"><label>RUT</label>
                              <input id="rut" class="form-control" type="text" placeholder="Rut">
                           </div>
                           <div class="form-group"><label>Nombre</label>
                              <input id="nombre" class="form-control" type="text" placeholder="Nombre">
                           </div>
                           <div class="form-group"><label>Apellidos</label>
                              <input id="apellido" class="form-control" type="text" placeholder="Apellidos">
                           </div>
                           <div class="form-group"><label>Dirección</label>
                              <input id="direccion" class="form-control" type="text" placeholder="Dirección">
                           </div>
                           <div class="form-group"><label>Telefóno</label>
                              <input id="telefono" class="form-control" type="tel" placeholder="Telefóno">
                           </div>
                           <div class="form-group"><label>Email</label>
                              <input id="email" class="form-control" type="email" placeholder="Email">
                           </div>
                           <button id="btn_guardar" class="btn btn btn-primary">Guardar información</button>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </section><!-- Page footer-->
      <footer class="footer-container"><span>&copy; 2019 - Angle</span></footer>
   </div><!-- =============== VENDOR SCRIPTS ===============-->
   <!-- MODERNIZR-->
   <script src="vendor/jquery/dist/jquery.js"></script>
   <script src="vendor/modernizr/modernizr.custom.js"></script><!-- STORAGE API-->
   <script src="vendor/js-storage/js.storage.js"></script><!-- SCREENFULL-->
   <script src="vendor/screenfull/dist/screenfull.js"></script><!-- i18next-->
   <script src="vendor/i18next/i18next.js"></script>
   <script src="vendor/i18next-xhr-backend/i18nextXHRBackend.js"></script>
   <!-- =============== PAGE VENDOR SCRIPTS ===============-->
   <!-- =============== APP SCRIPTS ===============-->
   <script src="js/app.js"></script>

   <!-- =============== Metodo para guardar datos en BD usando el metodo POST (poner los campos a llenar con su id respactivo) ===============-->
   <script type="text/javascript">

      var nuevo = true;

      function getUrlVars() {
         var vars = [], hash;
         var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
         for (var i = 0; i < hashes.length; i++) {
            hash = hashes[i].split('=');
            vars.push(hash[0]);
            vars[hash[0]] = hash[1];
         }
         return vars;
      }


      var rut = getUrlVars()["rut"];
      if (rut) {
         $('#titulo').text('Editar Cliente');
         nuevo = false;
         $.ajax({
            method: "GET",
            url: `http://localhost:80/taller-api/public/cliente/${rut}`,
            dataType: "script"
         }).done(function (data) {
            var obj = JSON.parse(data);
            console.log(obj);
            $('#rut').val(obj[0].rut_cliente);
            $('#nombre').val(obj[0].nombre);
            $('#apellido').val(obj[0].apellido);
            $('#direccion').val(obj[0].direccion);
            $('#telefono').val(obj[0].telefono);
            $('#email').val(obj[0].email);
         });
      } else {
         $('#titulo').text('Nuevo Cliente');
         nuevo = true;
      }

      if (nuevo) {
         $('#btn_guardar').click(function () {
            rut = $('#rut').val();
            nombre = $('#nombre').val();
            apellido = $('#apellido').val();
            direccion = $('#direccion').val();
            telefono = $('#telefono').val();
            email = $('#email').val();
            $.ajax({
               method: "POST",
               url: "http://localhost:80/taller-api/public/cliente/nuevo",
               data: { rut_cliente: rut, nombre, apellido, direccion, telefono, email }
            }).done(function (msg) {
               alert("Respuesta: " + msg);
            });
         })
      } else {
         $('#btn_guardar').click(function () {
            rut = $('#rut').val();
            nombre = $('#nombre').val();
            apellido = $('#apellido').val();
            direccion = $('#direccion').val();
            telefono = $('#telefono').val();
            email = $('#email').val();
            $.ajax({
               method: "PUT",
               url: `http://localhost:80/taller-api/public/cliente/modificar/${rut}`,
               data: { rut_cliente: rut, nombre, apellido, direccion, telefono, email }
            }).done(function (msg) {
               alert("Respuesta: " + msg);
            });
         })
      }
   </script>
</body>

</html>